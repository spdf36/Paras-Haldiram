<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Paras Haldiram — Inventory & Billing</title>

<style>
  :root{
    --accent:#d35400;
    --accent-dark:#a84400;
    --muted:#6b6b6b;
    --bg:#f8f5f0;
  }
  *{box-sizing:border-box;}
  body{
    font-family:Arial, sans-serif;
    margin:0;
    background:var(--bg);
    display:flex;
  }
  #sidebar{
    width:260px;
    background:var(--accent);
    color:#fff;
    height:100vh;
    padding:20px;
  }
  #sidebar h2{
    margin-top:0;
    text-align:center;
    font-size:24px;
  }
  #sidebar button{
    width:100%;
    padding:12px;
    margin:10px 0;
    border:none;
    background:#fff;
    color:var(--accent);
    font-size:16px;
    cursor:pointer;
    border-radius:4px;
  }
  #content{
    flex:1;
    padding:25px;
    overflow-y:auto;
  }
  table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
  }
  th,td{
    padding:10px;
    border:1px solid #ccc;
  }
  th{
    background:var(--accent);
    color:#fff;
  }
  .btn{
    padding:10px 16px;
    background:var(--accent);
    color:#fff;
    border:none;
    cursor:pointer;
    border-radius:4px;
  }
  #invoicePrint{
    display:none;
    background:#fff;
    padding:20px;
    border:2px solid var(--accent);
    margin-top:20px;
  }
</style>
</head>

<body>

<div id="sidebar">
  <h2>Inventory</h2>
  <button onclick="showSection('inventorySection')">Add Item</button>
  <button onclick="showSection('billingSection')">Billing</button>
  <button onclick="showSection('recordsSection')">Saved Bills</button>
</div>

<div id="content">

  <!-- ✅ Inventory Section -->
  <div id="inventorySection">
    <h2>Add / Update Inventory</h2>
    <input id="pName" placeholder="Product Name" style="width:100%;padding:10px;"><br><br>
    <input id="pPrice" type="number" placeholder="Price" style="width:100%;padding:10px;"><br><br>
    <button class="btn" onclick="addProduct()">Save Item</button>

    <table id="inventoryTable"></table>
  </div>

  <!-- ✅ Billing Section -->
  <div id="billingSection" style="display:none;">
    <h2>Billing</h2>

    <select id="billingProduct" style="width:100%;padding:10px;"></select><br><br>
    <input id="billingQty" type="number" placeholder="Quantity" style="width:100%;padding:10px;"><br><br>
    <button class="btn" onclick="addToBill()">Add to Bill</button>

    <table id="billTable"></table>

    <h3 id="totalAmount" style="text-align:right;margin-top:10px;">Total: ₹0.00</h3>
    <button class="btn" onclick="saveBill()">Save Bill & Generate Invoice</button>
  </div>

  <!-- ✅ Records section -->
  <div id="recordsSection" style="display:none;">
    <h2>Saved Bills</h2>
    <div id="recordsList"></div>
  </div>

  <!-- ✅ Invoice Display -->
  <div id="invoicePrint"></div>
  <h3 id="lastInvoiceArea"></h3>

</div>

<script>
/* -----------------------
     GLOBAL VARIABLES
------------------------- */
let inventory = JSON.parse(localStorage.getItem("inventory") || "[]");
let bills = JSON.parse(localStorage.getItem("bills") || "[]");
let currentBill = [];
let invoiceContent = document.querySelector("#invoicePrint");
let lastInvoiceArea = document.querySelector("#lastInvoiceArea");

/* -----------------------
      NAVIGATION
------------------------- */
function showSection(id){
  document.querySelectorAll("#content > div").forEach(sec => sec.style.display="none");
  document.getElementById(id).style.display="block";
}

/* -----------------------
   SAVE INVENTORY ITEM
------------------------- */
function addProduct(){
  const name = pName.value.trim();
  const price = +pPrice.value;

  if(!name || !price) return alert("Enter product name & price");

  inventory.push({ name, price });
  localStorage.setItem("inventory", JSON.stringify(inventory));
  loadInventory();
  loadDropdown();

  pName.value = "";
  pPrice.value = "";
}

/* -----------------------
   SHOW INVENTORY TABLE
------------------------- */
function loadInventory(){
  inventoryTable.innerHTML = `
    <tr><th>Name</th><th>Price</th></tr>
    ${inventory.map(p => `
      <tr>
        <td>${p.name}</td>
        <td>₹${p.price}</td>
      </tr>
    `).join("")}
  `;
}

/* -----------------------
   LOAD PRODUCTS IN BILL
------------------------- */
function loadDropdown(){
  billingProduct.innerHTML = `
    <option value="">Select Product</option>
    ${inventory.map(p => `<option value="${p.name}">${p.name} — ₹${p.price}</option>`).join("")}
  `;
}

/* -----------------------
      BILLING
------------------------- */
function addToBill(){
  const name = billingProduct.value;
  const qty = +billingQty.value;
  if(!name || qty<=0) return alert("Select product and enter qty");

  const item = inventory.find(p => p.name === name);
  currentBill.push({ name, price:item.price, qty });

  updateBillTable();
}

function updateBillTable(){
  billTable.innerHTML = `
    <tr><th>Name</th><th>Qty</th><th>Amount</th></tr>
    ${currentBill.map(i => `
      <tr>
        <td>${i.name}</td>
        <td>${i.qty}</td>
        <td>₹${(i.qty*i.price).toFixed(2)}</td>
      </tr>
    `).join("")}
  `;

  const total = currentBill.reduce((t,i)=> t + i.qty * i.price, 0);
  totalAmount.textContent = `Total: ₹${total.toFixed(2)}`;
}

/* -----------------------
      SAVE BILL + INVOICE
------------------------- */
function saveBill(){
  const total = currentBill.reduce((t,i)=> t + i.qty * i.price, 0);
  if(total<=0) return alert("Add items first!");

  const sale = {
    invoiceNo: bills.length + 1,
    date: new Date().toLocaleString(),
    items: [...currentBill],
    total
  };

  bills.push(sale);
  localStorage.setItem("bills", JSON.stringify(bills));

  showInvoice(sale);
  currentBill = [];
  updateBillTable();
  loadRecords();
}

/* -----------------------
 ✅ YOUR UPDATED INVOICE UI
------------------------- */
function showInvoice(sale, docId){
  const rows = sale.items.map((it, idx) => `
      <tr>
        <td style="border:1px solid #e91b1b; padding:6px; text-align:center;">${idx + 1}</td>
        <td style="border:1px solid #e91b1b; padding:6px;">${it.name}</td>
        <td style="border:1px solid #e91b1b; padding:6px; text-align:center;">${it.qty}</td>
        <td style="border:1px solid #e91b1b; padding:6px; text-align:right;">₹${(it.price * it.qty).toFixed(2)}</td>
      </tr>
  `).join("");

  invoiceContent.innerHTML = `
  <div style="border:3px solid #e91b1b; padding:18px; font-family:Arial;">

    <h2 style="text-align:center; color:#e91b1b; margin:0; font-size:28px;">
      KHODEL CENTER (PARTY)
    </h2>

    <div style="text-align:center; font-size:16px; color:#e91b1b; margin-top:4px;">
      DEALER OF HALDIRAM’S PRODUCTS<br>
      WHOLESALE & RETAIL
      <br><small>Papad, Chips, Bhel, Namkeen, Sey, Chutney, Syrup, Biscuits, Chocolate and all Haldiram products.</small>
      <br>Bardoli Road, near Rajhans School
      <br><strong>For trade use only</strong>
    </div>

    <div style="display:flex; justify-content:space-between; margin-top:20px; font-size:18px;">
      <div>Name: _________________________</div>
      <div>Bill No.: <strong>${sale.invoiceNo}</strong></div>
    </div>

    <table style="width:100%; border-collapse:collapse; margin-top:15px; font-size:17px;">
      <thead>
        <tr style="background:#e91b1b; color:white;">
          <th style="border:1px solid #e91b1b; padding:6px;">No.</th>
          <th style="border:1px solid #e91b1b; padding:6px;">Description</th>
          <th style="border:1px solid #e91b1b; padding:6px;">Quantity</th>
          <th style="border:1px solid #e91b1b; padding:6px;">Amount</th>
        </tr>
      </thead>
      <tbody>${rows}</tbody>
    </table>

    <div style="display:flex; justify-content:space-between; margin-top:10px; font-size:18px;">
      <div><strong>Final Amount</strong></div>
      <div><strong>Total: ₹${sale.total.toFixed(2)}</strong></div>
    </div>

    <div style="text-align:right; margin-top:40px; font-size:18px;">
      Signature ____________________
    </div>

  </div>
  `;

  invoicePrint.style.display = "block";
  lastInvoiceArea.innerText = `Invoice ${sale.invoiceNo} — ${sale.date}`;
  if(docId) lastInvoiceArea.dataset.docId = docId;
}

/* -----------------------
      LOAD SAVED BILLS
------------------------- */
function loadRecords(){
  recordsList.innerHTML = bills.map(b => `
    <div style="padding:10px;background:#eee;margin:6px;border-radius:4px;cursor:pointer;"
         onclick='showInvoice(${JSON.stringify(b)})'>
       Invoice ${b.invoiceNo} — Total ₹${b.total}
    </div>
  `).join("");
}

/* INIT */
loadInventory();
loadDropdown();
loadRecords();
</script>
</body>
</html>













